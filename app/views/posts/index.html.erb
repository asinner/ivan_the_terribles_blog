<% cache 'v19' do %>
<h1>Ivan the Terrible's Blog</h1>
<% @posts.each do |post| %>
  <h2>Post <%= "#{post.id}: #{post.title}" %></h2>
  <div class="post" data-msg='<%= post.body %>'>
		<%= truncate(post.body, length: 160) %>
		<%= link_to 'More ›', '#', onclick: 'reveal(this);' %>
	</div>
  <%= link_to 'Show', post %> |
  <%= link_to 'Edit', edit_post_path(post) %> |
  <%= link_to 'Destroy', post, method: :delete %><br>

	<% post.comments.each do |comment| %>
	  <h3>Comment <%= comment.id %>:</h3>
	  <p data-msg='<%= comment.body %>'>
			<%= truncate(comment.body, length: 160) %>
			<%= link_to 'More ›', '#', onclick: 'reveal(this);' %>
		</p>
		<% comment.replies.each do |reply| %>
			<h4>Reply <%= reply.id %>:</h4>
			<p data-msg='<%= reply.body %>'>
				<%= truncate(reply.body, length: 160) %>
				<%= link_to 'More ›', '#', onclick: 'reveal(this);' %>
			</p>
		<% end %>				
	<% end %>
<% end %>
<br />

<%= link_to 'New Post', new_post_path %>

<% end %>